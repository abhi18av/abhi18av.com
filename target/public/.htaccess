RewriteEngine On
RewriteCond %{HTTPS} !=on
RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

ErrorDocument 404 /404.html

RedirectMatch 302 /aleph-dam https://alephdam.200ok.ch

<IfModule mod_expires.c>
ExpiresActive On

# HTML
ExpiresByType text/html "access plus 2 days"

# Favicon
ExpiresByType image/x-icon "access plus 1 year"

# Images
ExpiresByType image/gif "access plus 1 month"
ExpiresByType image/png "access plus 1 month"
ExpiresByType image/jpg "access plus 1 month"
ExpiresByType image/jpeg "access plus 1 month"

# Javascript
ExpiresByType application/javascript "access plus 1 month"

# CSS
ExpiresByType text/css "access plus 1 month"

# Do not cache app.css, index.html and blog.html
# TODO: A better solution would be to cache it and use query strings to update to new versions
<FilesMatch "\.(app.css)$">
ExpiresActive Off
</FilesMatch>
<FilesMatch "\.(index.html)$">
ExpiresActive Off
</FilesMatch>
<FilesMatch "\.(blog.html)$">
ExpiresActive Off
</FilesMatch>
</IfModule>

<IfModule mod_deflate.c>
    #The following line is enough for .js and .css
    AddOutputFilter DEFLATE js css

    #The following line also enables compression by file content type, for the following list of Content-Type:s
    AddOutputFilterByType DEFLATE text/html text/plain text/xml application/xml text/css image/svg+xml

    #The following lines are to avoid bugs with some browsers
    BrowserMatch ^Mozilla/4 gzip-only-text/html
    BrowserMatch ^Mozilla/4\.0[678] no-gzip
    BrowserMatch \bMSIE !no-gzip !gzip-only-text/html
</IfModule>

<IfModule mod_headers.c>
  <FilesMatch "\.(js|css|xml|gz)$">
    Header append Vary: Accept-Encoding
  </FilesMatch>
</IfModule>
