<!DOCTYPE html>
<html lang="en"><head><meta charset="utf-8"><meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible"><meta content="width=device-width, initial-scale=1.0, user-scalable=no" name="viewport"><link href="/apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180"><link href="/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png"><link href="/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png"><link href="/manifest.json" rel="manifest"><link color="#5bbad5" href="/safari-pinned-tab.svg" rel="mask-icon"><meta content="#ffffff" name="theme-color"><link href="/css/normalize.css" rel="stylesheet"><link href="/css/app.css" rel="stylesheet"><title>X1 Carbon 6th gen about 50% slower on Linux - 200ok</title><link href="/rss.xml" rel="alternate" title="200ok - Consultancy, Research Lab, Incubator" type="application/rss+xml"><link href="/atom.xml" rel="alternate" title="200ok - Consultancy, Research Lab, Incubator" type="application/atom+xml"><meta content="X1 Carbon 6th gen about 50% slower on Linux" name="description"><meta content="X1 Carbon 6th gen about 50% slower on Linux - 200ok" property="og:title"><meta content="article" property="og:type"><meta content="X1 Carbon 6th gen about 50% slower on Linux" property="og:description"><meta content="https://200ok.ch/posts/2018-09-26_X1_carbon_6th_gen_about_50_percent_slower_on_Linux.html" property="og:url"><meta content="https://200ok.ch/img/x1_without_cpu_fix.png" property="og:image"><meta content="summary" name="twitter:card"><meta content="@twohundredok" name="twitter:site"><meta content="X1 Carbon 6th gen about 50% slower on Linux - 200ok" name="twitter:title"><meta content="https://200ok.ch/img/x1_without_cpu_fix.png" name="twitter:image"><meta content="X1 Carbon 6th gen about 50% slower on Linux" name="twitter:description"><link href="https://200ok.ch/posts/2018-09-26_X1_carbon_6th_gen_about_50_percent_slower_on_Linux.html" rel="canonical"><link href="/css/styles/solarized-light.css" rel="stylesheet"></head><body id="blog" itemscope itemtype="http://schema.org/Blog"><div class="top-bar"><div class="top-bar-left"><top-bar-title itemprop="image"><a href="/" id="logo"><img src="/img/200ok.svg"></a></top-bar-title></div><div class="top-bar-right"><ul class="menu"><li><a href="/blog.html">Blog</a></li><li><a href="/projects.html">Projects</a></li><li><a href="/team.html">Team</a></li><li><a href="/atom.xml" id="atom-feed"><span>&nbsp;</span>Feed</a></li></ul></div></div><main class="single-post"><div id="content"><article class="blog-post" itemscope itemtype="https://schema.org/BlogPosting"><h3 class="headline" itemprop="headline"><a class="nunito" href="/posts/2018-09-26_X1_carbon_6th_gen_about_50_percent_slower_on_Linux.html" itemprop="url">X1 Carbon 6th gen about 50% slower on Linux</a></h3><div class="subheader"><p class="post-meta"><time itemprop="datePublished">2018-09-26</time> - <span itemprop="wordCount">358</span> words - <span itemprop="timeRequired">2</span> min read</p><div class="byline"><img class="author-icon" src="/img/author.svg"><section class="author" itemprop="author" itemscope itemtype="https://schema.org/Person"><span itemprop="name">Alain M. Lafon</span></section><section class="author" itemprop="author" itemscope itemtype="https://schema.org/Person"><span itemprop="name">Pascal Huber</span></section></div></div><span itemprop="image" itemscope itemtype="https://schema.org/ImageObject"><meta content="190" itemprop="height"><meta content="349" itemprop="width"><meta content="https://200ok.ch/img/logo.png" itemprop="url"></span><div><div class="article-body" itemprop="articleBody"><p>The X1 Carbon is one of the most popular notebooks for the ambitious Linux user. With the 6th gen, however, there have been a couple of caveats. Some other notebooks of the same family (like the T480s) are affected, as well.</p>
<p>If you’re not running the latest BIOS version (1.30), we strongly recommend upgrading. The most pressing issues under Linux that have been solved since 1.23 are:</p>
<ul>
<li>ACPI S3 (Sleep/Suspend) doesn’t work (A workaround exists which involves patching the ACPI tables manually)</li>
<li>When using speakers through the audio jack, there was a pretty annoying fizzling sound - unless a certain audio volume was used. So specifically for business users who do a lot of conference calls, this was pretty hard to bear.</li>
</ul>
<p>You can upgrade your BIOS (without Windows) by following these instructions:</p>
<ul>
<li>https://github.com/fiji-flo/x1carbon2018s3</li>
<li>https://fwupd.org/lvfs/component/1023/all</li>
</ul>
<p>There’s one big caveat left even in the latest BIOS version, though. <strong>When you’re running a CPU intensive task, your machine will be only about 50% as fast as it could be!</strong></p>
<p>Let that sink in for a moment.</p>
<p>The reason is that under Linux the CPU frequency will be throttled very early - when reaching a temperature of 75 or 80C. The standard setting in Windows is 97C. Therefore, you might be running only on half the CPU frequency which you could, for many workloads.</p>
<p>Let me show you a couple screenshots:</p>
<p><strong>Running sysbench on 8 threads without the fix</strong></p>
<p><img src="/img/2018-09/x1_without_cpu_fix.png" /></p>
<p>As you can see, it takes my machine 43s to finish the benchmark.</p>
<p><strong>Running the same sysbench benchmark <em>with</em> the fix</strong></p>
<p><img src="/img/2018-09/x1_with_cpu_fix.png" /></p>
<p>Now, the same calculation takes only 18s - less than half the time before! These are reproducible numbers. We realize that the benchmarks would otherwise be rather short. It’s the same result when the benchmarks run substantially longer, too.</p>
<p>If you want to install the workaround yourself, here’s the fix which luckily was already provided by Francesco Palmarini: https://github.com/erpalma/lenovo-throttling-fix</p>
<p>There’s one slight adjustment we made, in order to have a longer battery life: In <code>/etc/lenovo.conf</code>, I set the cpu temp threshold for battery to 80C instead of 85C.</p>
</div><div class="tags"><img class="tag-icon" src="/img/tag.svg"><ul itemprop="keywords"><li class="category"><a href="/category/debian.html">Debian</a></li><li class="tag"><a href="/tags/x1_carbon.html">#x1_carbon</a></li><li class="tag"><a href="/tags/x1_carbon_6th_gen.html">#x1_carbon_6th_gen</a></li><li class="tag"><a href="/tags/linux.html">#linux</a></li></ul></div></div></article></div></main><footer><div itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><div class="name" itemprop="name">200ok GmbH</div><div itemprop="address" itemscope itemtype="https://schema.org/PostalAddress"><a href="https://goo.gl/maps/GNAoiNF7mbL2" title="View on Google Maps"><div itemprop="streetAddress">Badenerstrasse 313</div><div><span itemprop="postalCode">8003</span> <span itemprop="addressLocality">Zürich</span></div></a></div><div itemprop="telephone">+41 76 405 05 67</div><div itemprop="email"><a href="mailto:info@200ok.ch">info@200ok.ch</a></div><img itemprop="logo" src="https://200ok.ch/img/200ok.svg"></div></footer><div class="scripts" style="{:display &quot;none&quot;}"><script src="/js/vendor/bowser.min.js"></script><script async src="/js/ie_safeguard.js"></script><script async src="/js/tour.js"></script><script src="/js/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script><script>tour=null</script></div></body></html>